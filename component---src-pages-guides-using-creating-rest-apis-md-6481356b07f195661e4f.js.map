{"version":3,"sources":["webpack://dev-site-documentation-template/./src/pages/guides/using/creating_rest_apis.md"],"names":["_frontmatter","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"mappings":"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","file":"component---src-pages-guides-using-creating-rest-apis-md-6481356b07f195661e4f.js","sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\n\nimport DefaultLayout from \"/home/runner/work/adobe-io-runtime/adobe-io-runtime/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"creating-rest-apis\"\n    }}>{`Creating REST APIs`}</h1>\n    <p>{`You can create REST APIs from web actions you`}{`’`}{`ve deployed to Adobe I/O Runtime. Let`}{`’`}{`s assume that you`}{`’`}{`ve created four actions to manage CRUD operations for the `}<inlineCode parentName=\"p\">{`pet`}</inlineCode>{` entity:`}</p>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`CRUD Operation`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Action Name`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Create`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`addPet`}</inlineCode></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Read`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`getPet`}</inlineCode></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Update`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`updatePet`}</inlineCode></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Delete`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`deletePet`}</inlineCode></td>\n        </tr>\n      </tbody>\n    </table>\n    <p>{`You can map these actions to a REST API for managing `}<inlineCode parentName=\"p\">{`pet`}</inlineCode>{` resources:`}</p>\n    <table>\n      <thead parentName=\"table\">\n        <tr parentName=\"thead\">\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Endpoint`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`HTTP Method`}</th>\n          <th parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`Action Nam`}</th>\n        </tr>\n      </thead>\n      <tbody parentName=\"table\">\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`/pet`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`POST`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`addPet`}</inlineCode></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`/pet`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`GET`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`getPet`}</inlineCode></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`/pet/{id}`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`GET`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`getPet`}</inlineCode></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`/pet/{id}`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`PUT`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`updatePet`}</inlineCode></td>\n        </tr>\n        <tr parentName=\"tbody\">\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`/pet/{id}`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}>{`DELETE`}</td>\n          <td parentName=\"tr\" {...{\n            \"align\": null\n          }}><inlineCode parentName=\"td\">{`deletePet`}</inlineCode></td>\n        </tr>\n      </tbody>\n    </table>\n    <p>{`Let`}{`’`}{`s see how you can create this API, assuming you have the web actions are already deployed/created.`}</p>\n    <h1 {...{\n      \"id\": \"how-long-does-it-take-to-createupdate-an-api\"\n    }}>{`How long does it take to create/update an API`}</h1>\n    <p>{`When creating or updating a REST API, it can take up to 5 minutes to see the changes. `}</p>\n    <h2 {...{\n      \"id\": \"using-wsk-cli\"\n    }}>{`Using wsk CLI`}</h2>\n    <p>{`Using the `}<inlineCode parentName=\"p\">{`wsk api create`}</inlineCode>{` command, you create each API endpoint one-by-one. This command allows you to set a base path, path, method, and response type. We will set:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`wsk api create /pet-store /pet post createPet --response-type http\nwsk api create /pet-store /pet get getPet --response-type http\nwsk api create /pet-store /pet/{id} get getPet --response-type http\nwsk api create /pet-store /pet/{id} put updatePet --response-type http\nwsk api create /pet-store /pet/{id} delete deletePet --response-type http\n`}</code></pre>\n    <p>{`You can quickly see the API you`}{`’`}{`ve defined, including the fully qualified path, by running this command:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`wsk api list /pet-store\n`}</code></pre>\n    <p>{`Please note, that at this time `}<inlineCode parentName=\"p\">{`wsk api list`}</inlineCode>{` is not implemented. Instead, you have to use `}<inlineCode parentName=\"p\">{`wsk api list /enter-base-path`}</inlineCode>{`.`}</p>\n    <p>{`Here is an example of calling one of the endpoints:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`curl https://adobeioruntime.net:443/apis/<YOUR-NAMESPACE>/pet-store/pet/2345 -X get\n`}</code></pre>\n    <p>{`or`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`curl https://<YOUR-NAMESPACE>.adobeioruntime.net:443/apis/pet-store/pet/2345 -X GET\n`}</code></pre>\n    <p><strong parentName=\"p\">{`Note`}</strong>{` the change in the URL here in comparison to what the `}<inlineCode parentName=\"p\">{`wsk`}</inlineCode>{` returns. This is due some additional protections Runtime provides to segregate namespaces from each other when invoking web actions. The `}<inlineCode parentName=\"p\">{`wsk`}</inlineCode>{` generated link will still work but it will return a 308 redirect to your namespace's subdomain on Runtime. For a further discussion of this please see the `}<a parentName=\"p\" {...{\n        \"href\": \"securing_web_actions.md\"\n      }}>{`Securing Web Actions`}</a>{` page.`}</p>\n    <p>{`In the example above, the `}<inlineCode parentName=\"p\">{`{di}`}</inlineCode>{` value, 2335, will be mapped to a {payload.id}.`}</p>\n    <h2 {...{\n      \"id\": \"using-swagger-files\"\n    }}>{`Using Swagger files`}</h2>\n    <p>{`A neat feature when working with REST APIs is the support for Swagger files. This works for creating a new REST API from scratch or, if you already used the `}<inlineCode parentName=\"p\">{`wsk`}</inlineCode>{` CLI to create one,  saving the API as a Swagger definition file that you can use later on to restore the API.`}</p>\n    <p>{`Continuing the example above, if you run this command, you`}{`’`}{`ll create a Swagger definition file on your machine out of the pet-store API:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`wsk api get /pet-store > pet-store-swagger.json\n`}</code></pre>\n    <p>{`Suppose that you want to restore or create the same API, maybe in some other namespace. All you have to is to run:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{`wsk api create --config-file pet-store-swagger.json\n`}</code></pre>\n    <p>{`This will work as long as the actions are already created in that namespace.`}</p>\n    <h2 {...{\n      \"id\": \"enable-cors-on-an-http-resource\"\n    }}>{`Enable CORS on an HTTP Resource`}</h2>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS\"\n      }}>{`CORS`}</a>{` headers can be controlled in two ways: statically, or dynamically.`}</p>\n    <h3 {...{\n      \"id\": \"static-cors-response-with-openapi\"\n    }}>{`Static CORS Response with OpenAPI`}</h3>\n    <p>{`If the returned CORS headers can be static, no code is necesary. The REST APIs can be configured in OpenAPI 2.0 format, by defining the `}<inlineCode parentName=\"p\">{`options`}</inlineCode>{` method. The following snippet illustrates how to configure CORS headers:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`\"paths\": {\n    \"/test\": {\n      \"options\": {\n        \"responses\": {\n          \"204\": {\n            \"description\": \"Default CORS response\",\n            \"headers\": {\n              \"Access-Control-Allow-Origin\": {\n                \"type\": \"string\",\n                \"description\": \"Which origin can invoke the /test API\\\\n\",\n                \"default\": \"https://xyz.example.com\"\n              },\n              \"Access-Control-Allow-Methods\": {\n                \"type\": \"string\",\n                \"description\": \"Which methods are allowed\\\\n\",\n                \"default\": \"GET, POST, PUT\"\n              }\n            }\n          }\n        }\n      }\n    }\n}\n`}</code></pre>\n    <p>{`Once the `}<inlineCode parentName=\"p\">{`options`}</inlineCode>{` block is added to any HTTP resource, the system will respond with the configured headers, and their corresponding `}<inlineCode parentName=\"p\">{`default`}</inlineCode>{` values. In this example the response will be:`}</p>\n    <pre><code parentName=\"pre\" {...{}}>{` HTTP/1.1 204 No Content\n Access-Control-Allow-Methods: GET, POST, PUT\n Access-Control-Allow-Origin: https://xyz.example.com\n\n`}</code></pre>\n    <h4 {...{\n      \"id\": \"dynamic-cors-response-with-custom-actions\"\n    }}>{`Dynamic CORS Response with Custom Actions`}</h4>\n    <p>{`The CORS headers can also be returned by a dedicated function, which must be configured to handle the `}<inlineCode parentName=\"p\">{`options`}</inlineCode>{` HTTP Method. It works in the same fashion as the other HTTP Methods like `}<inlineCode parentName=\"p\">{`GET`}</inlineCode>{`, or `}<inlineCode parentName=\"p\">{`POST`}</inlineCode>{`.`}</p>\n    <p>{`The code bellow demonstrates an action that returns a CORS response:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`// save it as cors-action.js\nfunction main(params) {\n  return {\n    statusCode: 204,\n    headers: {\n      \"Access-Control-Allow-Origin\": \"https://xyz.example.com\",\n      \"Access-Control-Allow-Methods\": \"GET, POST, PUT\"\n    }\n  }\n}\n`}</code></pre>\n    <p>{`The web action must be created and configured for the CORS request:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`wsk action create handleCorsRequest ./cors-action.js --web true -a web-custom-options true\n\nwsk api create /pet-store /pet options handleCorsRequest --response-type http\n`}</code></pre>\n    <p>{`To test the CORS request get the URL of the action, and invoke it:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`wsk api list /pet-store\n# get the URL for the options action and invoke it\ncurl -i -X OPTIONS https://adobeioruntime.net/...\n# it should return\n HTTP/1.1 204 No Content\n Access-Control-Allow-Methods: GET, POST, PUT\n Access-Control-Allow-Origin: https://xyz.example.com\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"securing-the-api-endpoints\"\n    }}>{`Securing the API endpoints`}</h2>\n    <p>{`You secure an API the same way you`}{`’`}{`d do it for web actions. You can read more about this on the `}<a parentName=\"p\" {...{\n        \"href\": \"securing_web_actions.md\"\n      }}>{`Securing Web Actions`}</a>{` page.`}</p>\n    <p>{`Once you`}{`’`}{`ve enabled basic authentication for an action, you`}{`’`}{`d have to pass the `}<inlineCode parentName=\"p\">{`X-Require-Whisk-Auth`}</inlineCode>{` header and the secret you chose when making an API call. `}</p>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"sourceRoot":""}